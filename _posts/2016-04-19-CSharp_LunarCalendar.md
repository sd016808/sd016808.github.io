---
layout: post
title: 'C# 計算二十四節氣'
author: 'James Peng'
tags: ['C#']
---

![](..\images\2016-04-19-CSharp_LunarCalendar\lnDFeO0.png)

定氣法計算二十四節氣,二十四節氣是按地球公轉來計算的，並非是陰曆計算的節氣的定法有兩種。

古代曆法採用的稱為"恒氣"，即按時間把一年等分為24份，每一節氣平均得15天有餘，所以又稱"平氣"。

現代農曆採用的稱為"定氣"，即按地球在軌道上的位置為標準，一周360°，兩節氣之間相隔15°。

由於冬至時地球位於近日點附近，運動速度較快，因而太陽在黃道上移動15°的時間不到15天。

夏至前後的情況正好相反，太陽在黃道上移動較慢，一個節氣達16天之多。採用定氣時可以保證春、秋兩分必然在晝夜平分的那兩天。


<table border="1" width="100%" bordercolor="#800080">
  <tbody><tr>
    <td width="31%">表示寒來暑往變化</td>
    <td width="69%">立春、春分；立夏、夏至；立秋、秋分；立冬、冬至</td>
  </tr>
  <tr>
    <td width="31%">象徵氣溫變化</td>
    <td width="69%">小暑、大暑、處暑、小寒、大寒</td>
  </tr>
  <tr>
    <td width="31%">反映降水量</td>
    <td width="69%">雨水、穀雨、白露、寒露、霜降小雪、大雪</td>
  </tr>
  <tr>
    <td width="31%">反應物候現象或農事活動</td>
    <td width="69%">驚蟄、清明、小滿、芒種</td>
  </tr>
</tbody></table>


----------


<table border="1" width="100%">
  <tbody><tr>
    <td width="7%" align="center" bgcolor="#F2F2F2">次序</td>
    <td width="8%" align="center" bgcolor="#F2F2F2">季節</td>
    <td width="8%" align="center" bgcolor="#F2F2F2">節氣</td>
    <td width="13%" align="center" bgcolor="#F2F2F2">農曆</td>
    <td width="17%" align="center" bgcolor="#F2F2F2">公曆</td>
    <td width="47%" align="center" bgcolor="#F2F2F2">意義</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">1</td>
    <td width="8%" rowspan="6" bgcolor="#CCFFCC">春季</td>
    <td width="8%" bgcolor="#CCFFCC">立春</td>
    <td width="13%" bgcolor="#CCFFCC">正月節</td>
    <td width="17%" bgcolor="#CCFFCC">2月4/5日</td>
    <td width="47%" bgcolor="#CCFFCC">開始進入春天，萬物復蘇。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">2</td>
    <td width="8%" bgcolor="#CCFFCC">雨水</td>
    <td width="13%" bgcolor="#CCFFCC">正月中</td>
    <td width="17%" bgcolor="#CCFFCC">2月19/20日</td>
    <td width="47%" bgcolor="#CCFFCC">這時春風遍吹，天氣漸暖，冰雪溶化，空氣濕潤，雨水增多。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">3</td>
    <td width="8%" bgcolor="#CCFFCC">驚蟄</td>
    <td width="13%" bgcolor="#CCFFCC">二月節</td>
    <td width="17%" bgcolor="#CCFFCC">3月5/6日</td>
    <td width="47%" bgcolor="#CCFFCC">天氣轉暖，春雷震響，蟄伏在泥土裏的各種冬眠動物蘇醒過來及開始活動，所以叫驚蟄。大部分地區進入春耕。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">4</td>
    <td width="8%" bgcolor="#CCFFCC">春分</td>
    <td width="13%" bgcolor="#CCFFCC">二月中</td>
    <td width="17%" bgcolor="#CCFFCC">3月20/21日</td>
    <td width="47%" bgcolor="#CCFFCC">這一天南北兩半球晝夜相等。大部分地區越冬作物進入春季生長階段。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">5</td>
    <td width="8%" bgcolor="#CCFFCC">清明　</td>
    <td width="13%" bgcolor="#CCFFCC">三月節</td>
    <td width="17%" bgcolor="#CCFFCC">4月4/5日</td>
    <td width="47%" bgcolor="#CCFFCC">天氣晴朗溫暖，草木始發新枝芽，萬物開始生長，農民忙於春耕春種。人們在門口插上楊柳條，到郊外踏青，以及祭掃墳墓。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFCC">6</td>
    <td width="8%" bgcolor="#CCFFCC">穀雨</td>
    <td width="13%" bgcolor="#CCFFCC">三月中</td>
    <td width="17%" bgcolor="#CCFFCC">4月20/21日</td>
    <td width="47%" bgcolor="#CCFFCC">天氣較暖，雨量增加，是北方春耕作物播種的好季節，因為有雨水滋潤大地。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">7</td>
    <td width="8%" rowspan="6" bgcolor="#FED1D6">夏季</td>
    <td width="8%" bgcolor="#FED1D6">立夏</td>
    <td width="13%" bgcolor="#FED1D6">四月節</td>
    <td width="17%" bgcolor="#FED1D6">5月5/6日</td>
    <td width="47%" bgcolor="#FED1D6">夏天開始，雨水增多，農作物生長漸旺，田間工作日益繁忙。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">8</td>
    <td width="8%" bgcolor="#FED1D6">小滿</td>
    <td width="13%" bgcolor="#FED1D6">四月中</td>
    <td width="17%" bgcolor="#FED1D6">5月21/22日</td>
    <td width="47%" bgcolor="#FED1D6">大麥、冬小麥等夏收作物，已經結果、籽粒飽滿，但尚未成熟，所以叫小滿。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">9</td>
    <td width="8%" bgcolor="#FED1D6">芒種</td>
    <td width="13%" bgcolor="#FED1D6">五月節</td>
    <td width="17%" bgcolor="#FED1D6">6月5/6日</td>
    <td width="47%" bgcolor="#FED1D6">芒種表明小麥等有芒作物成熟，宜開始秋播，如晚穀、黍、稷等。長江中下游地區將進入黃梅季節，連綿陰雨。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">10</td>
    <td width="8%" bgcolor="#FED1D6">夏至</td>
    <td width="13%" bgcolor="#FED1D6">五月中</td>
    <td width="17%" bgcolor="#FED1D6">6月21/22日</td>
    <td width="47%" bgcolor="#FED1D6">陽光直射北回歸線，白天最長。從這一天起，進入炎熱季節，萬物生長最旺盛，雜草害蟲也迅速滋長。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">11</td>
    <td width="8%" bgcolor="#FED1D6">小暑</td>
    <td width="13%" bgcolor="#FED1D6">六月節</td>
    <td width="17%" bgcolor="#FED1D6">7月7/8日</td>
    <td width="47%" bgcolor="#FED1D6">正值初伏前後，天氣很熱但尚未酷熱，忙於夏秋作物的工作。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FED1D6">12</td>
    <td width="8%" bgcolor="#FED1D6">大暑</td>
    <td width="13%" bgcolor="#FED1D6">六月中</td>
    <td width="17%" bgcolor="#FED1D6">7月23/24日</td>
    <td width="47%" bgcolor="#FED1D6">正值中伏前後，一年最炎熱時期，喜溫作物迅速生長；雨水甚多。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">13</td>
    <td width="8%" rowspan="6" bgcolor="#FFFF99">秋季</td>
    <td width="8%" bgcolor="#FFFF99">立秋</td>
    <td width="13%" bgcolor="#FFFF99">七月節</td>
    <td width="17%" bgcolor="#FFFF99">8月7/8日</td>
    <td width="47%" bgcolor="#FFFF99">秋天開始，氣溫逐漸下降；中部地區早稻收割，晚稻開始移栽。 
    </td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">14</td>
    <td width="8%" bgcolor="#FFFF99">處暑</td>
    <td width="13%" bgcolor="#FFFF99">七月中</td>
    <td width="17%" bgcolor="#FFFF99">8月23/24日</td>
    <td width="47%" bgcolor="#FFFF99">氣候變涼的象徵，表示暑天終止，夏季火熱已經到了盡頭。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">15</td>
    <td width="8%" bgcolor="#FFFF99">白露</td>
    <td width="13%" bgcolor="#FFFF99">八月節</td>
    <td width="17%" bgcolor="#FFFF99">9月7/8日</td>
    <td width="47%" bgcolor="#FFFF99">天氣轉涼，地面水汽結露。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">16</td>
    <td width="8%" bgcolor="#FFFF99">秋分</td>
    <td width="13%" bgcolor="#FFFF99">八月中</td>
    <td width="17%" bgcolor="#FFFF99">9月23/24日</td>
    <td width="47%" bgcolor="#FFFF99">陽光直射赤道，晝夜幾乎相等。北方秋收秋種。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">17</td>
    <td width="8%" bgcolor="#FFFF99">寒露</td>
    <td width="13%" bgcolor="#FFFF99">九月節</td>
    <td width="17%" bgcolor="#FFFF99">10月8/9日</td>
    <td width="47%" bgcolor="#FFFF99">天氣轉涼，露水日多。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#FFFF99">18</td>
    <td width="8%" bgcolor="#FFFF99">霜降</td>
    <td width="13%" bgcolor="#FFFF99">九月中</td>
    <td width="17%" bgcolor="#FFFF99">10月23/24日</td>
    <td width="47%" bgcolor="#FFFF99">天氣已冷，開始有霜凍，所以叫霜降。南方仍可秋收秋種。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFFF">19</td>
    <td width="8%" rowspan="6" bgcolor="#CCFFFF">冬季</td>
    <td width="8%" bgcolor="#CCFFFF">立冬</td>
    <td width="13%" bgcolor="#CCFFFF">十月節</td>
    <td width="17%" bgcolor="#CCFFFF">11月7/8日</td>
    <td width="47%" bgcolor="#CCFFFF">冬季開始，一年的田間操作結束，作物收割之後要收藏起來。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFFF">20</td>
    <td width="8%" bgcolor="#CCFFFF">小雪</td>
    <td width="13%" bgcolor="#CCFFFF">十月中</td>
    <td width="17%" bgcolor="#CCFFFF">11月22/23日</td>
    <td width="47%" bgcolor="#CCFFFF">氣溫下降，黃河流域開始降雪；北方已進入封凍季節。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFFF">21</td>
    <td width="8%" bgcolor="#CCFFFF">大雪</td>
    <td width="13%" bgcolor="#CCFFFF">十一月節</td>
    <td width="17%" bgcolor="#CCFFFF">12月7/8日</td>
    <td width="47%" bgcolor="#CCFFFF">黃河流域一帶漸有積雪；而北方已是萬里冰封。</td>
  </tr><tr>
    <td width="7%" bgcolor="#CCFFFF">22</td>
    <td width="8%" bgcolor="#CCFFFF">冬至</td>
    <td width="13%" bgcolor="#CCFFFF">十一月中</td>
    <td width="17%" bgcolor="#CCFFFF">12月21/22日</td>
    <td width="47%" bgcolor="#CCFFFF">這一天，陽光幾乎直射南回歸線，北半球白晝最短，黑夜最長。</td>
  </tr>
  <tr>
    <td width="7%" bgcolor="#CCFFFF">23</td>
    <td width="8%" bgcolor="#CCFFFF">小寒</td>
    <td width="13%" bgcolor="#CCFFFF">十二月節</td>
    <td width="17%" bgcolor="#CCFFFF">1月5/6日</td>
    <td width="47%" bgcolor="#CCFFFF">開始進入寒冷季節。冷氣積久而寒，大部分地區進入嚴寒時期。</td>
    </tr><tr>
    <td width="7%" bgcolor="#CCFFFF">24</td>
    <td width="8%" bgcolor="#CCFFFF">大寒</td>
    <td width="13%" bgcolor="#CCFFFF">十二月中</td>
    <td width="17%" bgcolor="#CCFFFF">1月20/21日</td>
    <td width="47%" bgcolor="#CCFFFF">大寒就是天氣寒冷到了極點的意思。大寒前後是一年中最冷的時候。</td>
  </tr>
</tbody></table>

----------


## 用法1 ##

~~~csharp

        /// <summary>
        /// 定氣法計算二十四節氣,二十四節氣是按地球公轉來計算的，並非是陰曆計算的
        /// 節氣的定法有兩種。古代曆法採用的稱為"恒氣"，即按時間把一年等分為24份，
        /// 每一節氣平均得15天有餘，所以又稱"平氣"。現代農曆採用的稱為"定氣"，即
        /// 按地球在軌道上的位置為標準，一周360°，兩節氣之間相隔15°。由於冬至時地
        /// 球位於近日點附近，運動速度較快，因而太陽在黃道上移動15°的時間不到15天。
        /// 夏至前後的情況正好相反，太陽在黃道上移動較慢，一個節氣達16天之多。採用
        /// 定氣時可以保證春、秋兩分必然在晝夜平分的那兩天。
        /// </summary>
        /// <param name="date1">日期</param>
        /// <returns>節氣名稱</returns>
        public static string ChineseTwentyFourDay(DateTime date1)
        {
            string[] SolarTerm = new string[] { "小寒", "大寒", "立春", "雨水", "驚蟄", "春分", "清明", "穀雨", "立夏", "小滿", "芒種", "夏至", "小暑", "大暑", "立秋", "處暑", "白露", "秋分", "寒露", "霜降", "立冬", "小雪", "大雪", "冬至" };
            int[] sTermInfo = new int[] { 0, 21208, 42467, 63836, 85337, 107014, 128867, 150921, 173149, 195551, 218072, 240693, 263343, 285989, 308563, 331033, 353350, 375494, 397447, 419210, 440795, 462224, 483532, 504758 };
            DateTime baseDateAndTime = new DateTime(1900, 1, 6, 2, 5, 0); //#1/6/1900 2:05:00 AM#
            DateTime newDate;
            double num;
            int y;
            string tempStr = "";


            y = date1.Year;


            for (int i = 1; i <= 24; i++)
            {
                num = 525948.76 * (y - 1900) + sTermInfo[i - 1];


                newDate = baseDateAndTime.AddMinutes(num);//按分鐘計算
                if (newDate.DayOfYear == date1.DayOfYear)
                {
                    tempStr = SolarTerm[i - 1];
                    break;
                }
            }
            return tempStr;
        }
~~~

![](..\images\2016-04-19-CSharp_LunarCalendar\CnSHlJm.png)



----------


## 用法2 ##

~~~csharp

        /// <summary>
        /// 計算國曆當天對應的節氣 ，""表示不是節氣
        /// </summary>
        /// <returns>節氣名稱，""表示不是節氣</returns>
        private static string l_GetLunarHolDay(DateTime date1)
        {
            //*********************************************************************************
            // 節氣無任何確定規律,所以只好建立表格對應
            //**********************************************************************************}
            // 數據格式說明:
            // 如 1901 年的節氣為
            // 1月 2月 3月 4月 5月 6月 7月 8月 9月 10月 11月 12月
            // 6, 21, 4, 19, 6, 21, 5, 21, 6,22, 6,22, 8, 23, 8, 24, 8, 24, 8, 24, 8, 23, 8, 22
            // 9, 6, 11,4, 9, 6, 10,6, 9,7, 9,7, 7, 8, 7, 9, 7, 9, 7, 9, 7, 8, 7, 15
            // 上面第一行數據為每月節氣對應日期,15減去每月第一個節氣,每月第二個節氣減去15得第二行
            // 這樣每月兩個節氣對應數據都小於16,每月用一個陣列元素存放
            // 高位元(high-bit)存放第一個節氣數據,低位元(low-bit)存放第二個節氣的數據,可得下表
            byte[] gLunarHoliDay ={
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1901
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1902
              0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1903
              0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //1904
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1905
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1906
              0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1907
              0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1908
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1909
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1910
              0x96, 0xA5, 0x87, 0x96, 0x87, 0x87, 0x79, 0x69, 0x69, 0x69, 0x78, 0x78, //1911
              0x86, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1912
              0x95, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1913
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1914
              0x96, 0xA5, 0x97, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1915
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1916
              0x95, 0xB4, 0x96, 0xA6, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1917
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x77, //1918
              0x96, 0xA5, 0x97, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1919
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1920
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1921
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x77, //1922
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x69, 0x69, 0x78, 0x78, //1923
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1924
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x87, //1925
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1926
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1927
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1928
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1929
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1930
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x87, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1931
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1932
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1933
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1934
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1935
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1936
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1937
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1938
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1939
              0x96, 0xA5, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1940
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1941
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1942
              0x96, 0xA4, 0x96, 0x96, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1943
              0x96, 0xA5, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1944
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1945
              0x95, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1946
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1947
              0x96, 0xA5, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1948
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x79, 0x78, 0x79, 0x77, 0x87, //1949
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1950
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x79, 0x79, 0x79, 0x69, 0x78, 0x78, //1951
              0x96, 0xA5, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1952
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1953
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x68, 0x78, 0x87, //1954
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1955
              0x96, 0xA5, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1956
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1957
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1958
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1959
              0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1960
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1961
              0x96, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1962
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1963
              0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1964
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1965
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1966
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1967
              0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1968
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1969
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1970
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x79, 0x69, 0x78, 0x77, //1971
              0x96, 0xA4, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1972
              0xA5, 0xB5, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1973
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1974
              0x96, 0xB4, 0x96, 0xA6, 0x97, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1975
              0x96, 0xA4, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x89, 0x88, 0x78, 0x87, 0x87, //1976
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1977
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //1978
              0x96, 0xB4, 0x96, 0xA6, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1979
              0x96, 0xA4, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1980
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x77, 0x87, //1981
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1982
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x78, 0x79, 0x78, 0x69, 0x78, 0x77, //1983
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //1984
              0xA5, 0xB4, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //1985
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1986
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x79, 0x78, 0x69, 0x78, 0x87, //1987
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1988
              0xA5, 0xB4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1989
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //1990
              0x95, 0xB4, 0x96, 0xA5, 0x86, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1991
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1992
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1993
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1994
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x76, 0x78, 0x69, 0x78, 0x87, //1995
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //1996
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //1997
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //1998
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //1999
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2000
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2001
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2002
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //2003
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2004
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2005
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2006
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x69, 0x78, 0x87, //2007
              0x96, 0xB4, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2008
              0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2009
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2010
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x78, 0x87, //2011
              0x96, 0xB4, 0xA5, 0xB5, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2012
              0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2013
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2014
              0x95, 0xB4, 0x96, 0xA5, 0x96, 0x97, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2015
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2016
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2017
              0xA5, 0xB4, 0xA6, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2018
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2019
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x86, //2020
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2021
              0xA5, 0xB4, 0xA5, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2022
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x79, 0x77, 0x87, //2023
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2024
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2025
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2026
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2027
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2028
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2029
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2030
              0xA5, 0xB4, 0x96, 0xA5, 0x96, 0x96, 0x88, 0x78, 0x78, 0x78, 0x87, 0x87, //2031
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2032
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x86, //2033
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x78, 0x88, 0x78, 0x87, 0x87, //2034
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2035
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2036
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x86, //2037
              0xA5, 0xB3, 0xA5, 0xA5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2038
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2039
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x96, //2040
              0xA5, 0xC3, 0xA5, 0xB5, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2041
              0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x88, 0x88, 0x88, 0x78, 0x87, 0x87, //2042
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2043
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x88, 0x87, 0x96, //2044
              0xA5, 0xC3, 0xA5, 0xB4, 0xA5, 0xA6, 0x87, 0x88, 0x87, 0x78, 0x87, 0x86, //2045
              0xA5, 0xB3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x88, 0x78, 0x87, 0x87, //2046
              0xA5, 0xB4, 0x96, 0xA5, 0xA6, 0x96, 0x88, 0x88, 0x78, 0x78, 0x87, 0x87, //2047
              0x95, 0xB4, 0xA5, 0xB4, 0xA5, 0xA5, 0x97, 0x87, 0x87, 0x88, 0x86, 0x96, //2048
              0xA4, 0xC3, 0xA5, 0xA5, 0xA5, 0xA6, 0x97, 0x87, 0x87, 0x78, 0x87, 0x86, //2049
              0xA5, 0xC3, 0xA5, 0xB5, 0xA6, 0xA6, 0x87, 0x88, 0x78, 0x78, 0x87, 0x87}; //2050

            // 位元陣列 gLanarHoliDay 存放每年的二十四節氣對應的陽曆日期
            // 每年的二十四節氣對應的陽曆日期幾乎固定，平均分佈於十二個月中
            // 1月 2月 3月 4月 5月 6月
            // 小寒 大寒 立春 雨水 驚蟄 春分 清明 谷雨 立夏 小滿 芒種 夏至
            // 7月 8月 9月 10月 11月 12月
            // 小暑 大暑 立秋 處暑 白露 秋分 寒露 霜降 立冬 小雪 大雪 冬至
            string[] LunarHolDayName =
                  {
                  "小寒", "大寒", "立春", "雨水",
                  "驚蟄", "春分", "清明", "穀雨",
                  "立夏", "小滿", "芒種", "夏至",
                  "小暑", "大暑", "立秋", "處暑",
                  "白露", "秋分", "寒露", "霜降",
                  "立冬", "小雪", "大雪", "冬至"};

            const ushort START_YEAR = 1901;
            const ushort END_YEAR = 2050;

            byte Flag;
            int Day, iYear, iMonth, iDay;
            iYear = date1.Year;
            if ((iYear < 1901) || (iYear > END_YEAR))
            { return ""; };
            iMonth = date1.Month;
            iDay = date1.Day;
            Flag = gLunarHoliDay[(iYear - START_YEAR) * 12 + iMonth - 1];
            if (iDay < 15)
            { Day = 15 - ((Flag >> 4) & 0x0f); }
            else
            { Day = (Flag & 0x0f) + 15; };
            if (iDay == Day)
            {
                if (iDay > 15)
                { return LunarHolDayName[(iMonth - 1) * 2 + 1]; }
                else
                { return LunarHolDayName[(iMonth - 1) * 2]; }
            }
            else
            { return ""; };
        }
~~~

![](..\images\2016-04-19-CSharp_LunarCalendar\42WSObC.png)

----------

參考：

- http://www.hko.gov.hk/gts/astron2016/Solar_Term_2016_uc.htm
- http://ihouse.hkedcity.net/~hm1203/atmosphere/climate-china-24.htm
- http://fecbob.pixnet.net/blog/post/38088837
